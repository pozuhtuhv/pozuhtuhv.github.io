---
layout: default
---

<style>
  #canvas-container {
    position: relative;
    width: 100%;
    max-width: 800px;
    margin: auto;
  }
  canvas {
    width: 100%;
    height: auto;
    display: block;
    border: 1px solid #ccc;
  }
</style>

<section class="page_title">
  <h1>ImgMaker</h1>
</section>

<section class="posts">
  <input type="file" id="imageUploader" accept="image/*" />
  <br>
  <input type="text" id="coverText" placeholder="표지 제목 입력" />
  <br>
  <label>어두운 배경 투명도:</label>
  <input type="range" id="opacitySlider" min="0" max="1" step="0.05" value="0.5" />
  <br><br>
  <div id="canvas-container">
    <canvas id="coverCanvas"></canvas>
  </div>
  <br>
  <button id="saveBtn">이미지 저장</button>

  <script>
    const uploader = document.getElementById("imageUploader");
    const canvas = document.getElementById("coverCanvas");
    const ctx = canvas.getContext("2d");
    const opacitySlider = document.getElementById("opacitySlider");
    const coverTextInput = document.getElementById("coverText");
    const saveBtn = document.getElementById("saveBtn");

    let img = new Image();

    uploader.addEventListener("change", (e) => {
      const file = e.target.files[0];
      if (!file || !file.type.startsWith('image/')) {
        alert("이미지 파일을 선택하세요.");
        return;
      }

      const reader = new FileReader();
      reader.onload = function(evt) {
        img.onload = () => {
          canvas.width = img.width;
          canvas.height = img.height;
          draw();
        };
        img.src = evt.target.result;
      };
      reader.readAsDataURL(file);
    });

    function draw() {
      ctx.drawImage(img, 0, 0);
      const opacity = parseFloat(opacitySlider.value);
      ctx.fillStyle = `rgba(0, 0, 0, ${opacity})`;
      ctx.fillRect(0, 0, canvas.width, canvas.height);

      ctx.fillStyle = "white";
      ctx.font = `${canvas.width / 15}px sans-serif`;
      ctx.textAlign = "center";
      ctx.textBaseline = "middle";
      ctx.fillText(coverTextInput.value, canvas.width / 2, canvas.height / 2);
    }

    opacitySlider.addEventListener("input", draw);
    coverTextInput.addEventListener("input", draw);

    saveBtn.addEventListener("click", () => {
      const link = document.createElement('a');
      link.href = canvas.toDataURL("image/png");
      link.download = "cover.png";
      link.click();
    });
  </script>
</section>
